<!DOCTYPE html>
<html>
<head>
	<title>Eco-Tracker Home Screen</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="css/ecopage.css" rel="stylesheet">
  <!--<link href="css/bootstrap.min.css" rel="stylesheet">-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
</head>

<body>
	<div class="container">
		<nav class="navbar navbar-expand navbar-light bg-light justify-content-center  static-top">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link active" href="index">Today</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="month">This Month</a>
				</li>
			</ul>
		</nav>
		<br>
		
		<div class="text-center profilecss">
      <h2>Today's Emmisions</h2>
			<span class="dot" id="ccolor">
				<h1 id="score">9.8L</h1>
			</span>
		</div>
		<br>
		<div class="text-xs-center">Commute</div>
		<div class="progress">
			<div class="progress-bar" role="progressbar" style="width: 40%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" id="cpb">3.1 liters</div>
		</div>
		<br>
		<div class="text-xs-center">Food</div>
		<div class="progress">
			<div class="progress-bar" role="progressbar" style="width: 40%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" id="fpb">4 liters</div>
		</div>
		<br>
		<div class="text-xs-center">Waste</div>
		<div class="progress">
			<div class="progress-bar" role="progressbar" style="width: 28%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" id="wpb">2.4 liters</div>
		</div>


	<nav class="navbar navbar-expand navbar-light bg-light justify-content-center  fixed-top">
		<ul class="navbar-nav">
      <li class="nav-item active">
        <a class="nav-link" href="/index">Today</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="month">This Month</a>
      </li>
    </ul>
  </nav>
<nav class="navbar navbar-expand navbar-dark bg-success justify-content-center  fixed-bottom">
    <ul class="navbar-nav">
      <li class="nav-item active">
        <a class="nav-link" href="index">
          <figure>
            <img src='foot.png' alt='foot icon' height="15" width='15'/>
            <figcaption>Summary</figcaption>
          </figure>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="tips">
          <figure>
            <img src='lightbulb.png' alt='lightbulb icon' height="15" width='15'/>
            <figcaption>Tips</figcaption>
          </figure>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="addpage">
          <figure>
            <img src='plus.png' alt='add icon' height="15" width='15'/>
            <figcaption>Add</figcaption>
          </figure>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="goal">
          <figure>
            <img src='goals.png' alt='goals icon' height="15" width='15'/>
            <figcaption>Goals</figcaption>
          </figure>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="profile">
          <figure>
            <img src='profile.png' alt='profile icon' height="15" width='15'/>
            <figcaption>Profile</figcaption>
          </figure>
        </a>
      </li>
    </ul>
  </nav>
  <script>
    //commute score
      var coscore = document.getElementById("cpb").innerHTML;
      coscore = coscore.replace(/[^\d.-]/g, '');
      var coscores = parseFloat(coscore);
      //waste score
      var wscore = document.getElementById("wpb").innerHTML;
      wscore = wscore.replace(/[^\d.-]/g, '');
      var wscores = parseFloat(wscore);
      //food score
      var fscore = document.getElementById("fpb").innerHTML;
      fscore = fscore.replace(/[^\d.-]/g, '');
      var fscores = parseFloat(fscore);
    // calculate the new progress bar from input for commute
    var commutebar = sessionStorage.getItem('commute');
    if(commutebar == null){commutebar = 0;}
    //var cprogress = document.getElementById("cpb").style.width;
    //var cprogress = parseFloat(cprogress);
    var oldScore = sessionStorage.getItem('prevScore');
    if(isNaN(oldScore)){oldScore = 0;}
            console.log("oldScore: " + oldScore);
    var percent = parseFloat(commutebar) + coscores + parseFloat(oldScore - coscores);
          sessionStorage.setItem('prevScore', percent);
    console.log("getCommute: " + commutebar);
    console.log("currCommute: " + coscores);
    console.log("total: " + percent);
    var finalpercent = Math.round(percent*1.0194);
    // calculate new score
      var cscore = Math.round((finalpercent)*10)/100;
    // calculate new scores
      document.getElementById("cpb").innerHTML = cscore +" liters";
      document.getElementById("cpb").style.width = (finalpercent*1.1)+"%";
      var eScore = cscore+wscores+fscores;
      console.log(eScore);
      document.getElementById("score").innerHTML = eScore + "L";
    // Change color of circle
      var redBound = Number(5);
      var yellowBound = Number(3);
      eScore = Number(eScore);
      if(eScore < yellowBound)
        {document.getElementById("ccolor").style.borderColor = "yellow";}
      else if(eScore < redBound)
        {document.getElementById("ccolor").style.borderColor = "red";}
      else{document.getElementById("ccolor").style.borderColor = "green";}
    //}
    /*
    else{
      document.getElementById("cpb").style.width = (commutepr)+"%";
      document.getElementById("score").innerHTML = coscores+wscores+fscores+"L";
    }*/
  </script>
</body>
</html>
